
# IdentityNow Integrations

Code that supports various IdentityNow integrations is available here.

## Splunk
The Splunk directory contains the hosted/on-prem Splunk implementation code. This works with the Splunk Add-on Builder, either with the hosted version of Splunk, or with a Splunk heavy forwarder, again with the Add-on Builder. For Splunk Cloud without a heavy forwarder or other SIEM tool integration, use the Syslog integration.

### splunk_identitynow_api.py
This is Splunk-hosted code needed to talk to the IdentityNow Audit API to work with a modular input in Splunk. See Splunk documentation for using the Add-on Builder to add an IdentityNow add-on to Splunk or the Splunk heavy forwarder. Copy and paste this code in to the Splunk add-on builder when it prompts for the Python code, replacing the default/automatically-generated code.

## Syslog
This Python script and associated files can be used to convert IdentityNow audit data into syslog-style events in a text log file. This enables integration with a variety of SIEM tools and other log aggregators, including Splunk Cloud.

### syslog_identitynow_api.py
This Python script can run on any generic Linux machine (tested on AWS Ubuntu in a T2-micro instance) and will periodically poll the IdentityNow audit API and write the audit events to a syslog-style log file on the Linux machine. This syslog type file can be used with the Splunk Universal Forwarder or with any SIEM tool that can monitor syslog files. 

To use this you should create a configuration yaml file: /etc/sailpoint_syslog.yaml with the following contents:
~~~
---
url: <https://my-org.identitynow.com>
clientId: <client ID issued by IdentityNow>
clientSecret: <client secret issued by IdentityNow>
interval: <a number of seconds to poll, 300 or larger, default is 3600>
~~~

The client Id and client secret can be generated by following the steps given in this Compass Community document:
<https://community.sailpoint.com/docs/DOC-4406>

Run the Python script as a service/daemon in your Linux system and it will create files:

Temp file: /tmp'/<clientId>_tmp.txt
Checkpoint File: /tmp/<clientId>_checkpoint.txt
Log file for script (errors, etc.): /var/log/sailpoint.log
Syslog file for the SIEM tool to monitor: /var/log'<clientId>_sailpoint.log

Configure your SIEM tool (Splunk, etc.) to monitor the /var/log'<clientId>_sailpoint.log file and it will render IdentityNow audit data in the SIEM tool.
